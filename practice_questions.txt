1. Pull total number of orders that were completed on 18th March 2023

SELECT COUNT(*) AS total_orders
FROM orders
WHERE completion_date = '2023-03-18';


2. Pull total number of orders that were completed on 18th March 2023 with the first name ‘John’ and last name ‘Doe’

SELECT COUNT(*) AS total_orders
FROM orders o
JOIN customers c ON o.customer_id = c.customer_id
WHERE o.completion_date = '2023-03-18' AND c.first_name = 'John' AND c.last_name = 'Doe';


3. Pull total number of customers that purchased in January 2023 and the average amount spend per customer

SELECT COUNT(*) AS total_customers, AVG(total_amount) AS average_amount_spent
FROM (
    SELECT c.customer_id, SUM(oi.amount) AS total_amount
    FROM customers c
    JOIN orders o ON c.customer_id = o.customer_id
    JOIN order_items oi ON o.order_id = oi.order_id
    WHERE o.completion_date >= '2023-01-01' AND o.completion_date <= '2023-01-31'
    GROUP BY c.customer_id
) AS subquery;



4. Pull the departments that generated less than $600 in 2022

SELECT department_name
FROM departments d
JOIN orders o ON d.department_id = o.department_id
WHERE o.completion_date >= '2022-01-01' AND o.completion_date <= '2022-12-31'
GROUP BY d.department_name
HAVING SUM(o.total_amount) < 600;




5. What is the most and least revenue we have generated by an order

SELECT MAX(total_amount) AS most_revenue, MIN(total_amount) AS least_revenue
FROM orders;


6. What were the orders that were purchased in our most lucrative order

SELECT o.order_id, o.completion_date, o.total_amount
FROM orders o
WHERE o.total_amount = (SELECT MAX(total_amount) FROM orders);


